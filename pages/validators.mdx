import { Callout } from "nextra-theme-docs";

# GenLayer Validator Requirements

Running a GenLayer Validator node ensures the security and reliability of the GenLayer network. Below are the requirements for running a GenLayer validator.

## Dependencies

### LLM Access

Each validator needs access to a Large Language Model (LLM) for executing and evaluating Intelligent Contracts.

It is up to each validator to select the model they want to use.

Possible options:

- Run an open-source model locally on the same machine with a GPU
- Run an open-source model on a different machine
- Connect to a hosted inference provider (OpenAI, Anthropic, Heurist, Atoma network etc.)

### ZKSync Full Node for the GenLayer Chain

Each validator needs access to a [ZKSync Full Node](https://docs.zksync.io/zksync-era/tooling/external-node) connected to the GenLayer chain.

One full node can be shared between multiple validators - TBD how many exactly.

## System Requirements

Below are the **initial** recommended system requirements. These guidelines may change as the network grows and evolves.

### RAM

- **Recommended:** 16 GB
- **Why:**
  - GenLayer's _genvm_ can spawn multiple Sub-VMs for contract calls and non-deterministic blocks.
  - Each Sub-VM can consume up to ~4 GB of RAM for storage.

### CPU

- **Recommended:** Modern multi-core processor with at least 8 cores/16 threads

### Storage

- **Recommended Disk Space:** 128 GB+
- **Preferred Type:** SSD or NVMe (M.2)

### Network

- **Recommended Connection:** Stable broadband

### Operating System

- **Recommended:** 64-bit Linux (Ubuntu, Debian, CentOS, etc.)

### Architecture

- **Recommended:** `AMD64`
- `ARM64` support will come in the future

### GPU (Optional)

- **Recommended:** If you plan to run advanced AI-models locally, a CUDA-compatible GPU could be beneficial.

<Callout emoji="⚠️">
  These requirements are a starting point. As GenLayer evolves and usage
  patterns change (e.g., more complex AI-driven Intelligent Contracts), the
  recommended hardware may change.
</Callout>

### Programs

- `docker` - for running the WebDriver container

## Setup

1. Decide on the version of the node you want to run by checking the available packages

   ```sh
   curl "https://storage.googleapis.com/storage/v1/b/gh-af/o?prefix=genlayer-node/bin/amd64" | grep -o '"name": *"[^"]*"' | sed -n 's/.*\/\(v[0-9.]*-[^/]*\)\/.*/\1/p' | sort -u
   ```

   You should see something like this

   ```sh
    v0.1.0-testnet002
    v0.1.0-testnet003
    v0.1.0-testnet004
    v0.1.0-testnet005
    v0.1.0-testnet006
    v0.1.0-testnet007
    v0.1.0-testnet008
   ```

1. Download the packaged application
   ```sh
   export version=v0.1.0-testnet008 # set your desired version here
   wget https://storage.googleapis.com/gh-af/genlayer-node/bin/amd64/${version}/genlayer-node-linux-amd64-${version}.tar.gz
   ```
1. Extract it
   ```sh
   tar -xzvf genlayer-node-linux-amd64-${version}.tar.gz
   ```
1. `cd` into it

   ```sh
   cd genlayer-node-linux-amd64
   ```

1. Configure

   1. [Configure `configs/node/config.yaml`](#configyaml)
   1. [Configure GenVM](#genvm)

1. Set up your account

   1. Create your account

      ```sh
      ./bin/genlayernode account new -c $(pwd)/configs/node/config.yaml --setup --password "your secret password" # Remember it! You will need it to unlock your account when running the node
      ```

      You will see something like this:

      ```sh
      Account created:
        New address: 0xA0b12Fd2f3F7e86fEC458D114A5E7a6f571160a8
        Account setup as a validator
      ```

      You should send that address to Genlayer Labs in order to get your validator added to the network.

1. Run

   1. Run the WebDriver container

      ```sh
      docker compose up -d
      ```

   1. Run the node

      ```sh
      export OPENAIKEY='sk-proj-fill-in-your-openai-key' # export all the necessary environment variables for the GenVM
      ./bin/genlayernode run -c $(pwd)/configs/node/config.yaml --password "your secret password" # The same password you used when creating the account
      ```

## Config

### `config.yaml`

```yaml
rollup:
  zksyncurl: "FILL_IN_YOUR_ZKSYNC_RPC_URL" # ZKSync RPC URL
  zksyncwebsocketurl: "FILL_IN_YOUR_ZKSYNC_WEBSOCKET_URL" # ZKSync WebSocket URL
consensus:
  contractmanageraddress: "0x07Eda7CdbA3b7aA72B288f8bB8Ae24A8D74e2675" # ConsensusManager Smart Contract Address
  contractmainaddress: "0x1b5366b03EF7ff3A430BaA9C38AC98B26aB33E0f" # ConsensusMain Smart Contract Address
  contractdataaddress: "0xE99401E8d03143518a606060CE762546D69a66fa" # ConsensusData Smart Contract Address
  contractidlenessaddress: "0xe2348B7724B4913932309C1aeD117A66063E0fD4" # ConsensusIdleness Smart Contract Address
datadir: "./data/node" # Cache directory
logging:
  level: "INFO" # Log level
node:
  mode: "validator" # "validator" or "archive"
  rpc:
    port: 9151 # JSON RPC port
    endpoints:
      groups:
        ethereum: true # Enable Ethereum RPC endpoints
        debug: false # Enable debug endpoints
      methods: # Enabled `eth_` methods
        eth_blockNumber: true
        eth_getBlockByNumber: true
        eth_getBlockByHash: true
        eth_sendRawTransaction: false
  ops:
    port: 9153 # Metrics port
    endpoints:
      metrics: true # Enable metrics endpoint
      health: true # Enable health endpoint
  dev: # Configuration for development purposes
    disableSubscription: false # Disable subscription

# Advanced configuration
merkleforest:
  maxdepth: 16
  dbpath: "./data/node/merkle/forest/data.db"
  indexdbpath: "./data/node/merkle/index.db"
merkletree:
  maxdepth: 16
  dbpath: "./data/node/merkle/tree/"
genvm:
  presets:
    - name: "preset_1"
      enabled: true
      type: "local"
  instances:
    - name: "genvm_local_1"
      usePreset: "preset_1"
      enabled: true
      type: "local"
      execution:
        timeout: 30s
      executable: "./third_party/genvm/bin/genvm"
      tempDir: "./tmp/genvm/genvm_local_1"
```

### GenVM

You can configure [the GenVM](/understand-genlayer-protocol/core-concepts/genvm) in `third_party/genvm/share/genvm/default-config.json`.
The json schema will guide you on how to configure each field.

#### Default config

```json
{
  "$schema": "https://raw.githubusercontent.com/yeagerai/genvm/refs/heads/main/doc/schemas/default-config.json",
  "modules": {
    "llm": {
      "config": {
        "host": "https://api.openai.com",
        "provider": "openai-compatible",
        "model": "gpt-4o-mini",
        "key_env_name": "OPENAIKEY"
      }
    },
    "web": {
      "config": {
        "host": "http://127.0.0.1:4444"
      }
    }
  }
}
```
