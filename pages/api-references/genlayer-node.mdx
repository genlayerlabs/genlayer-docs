# GenLayer Node API

The GenLayer Node provides a [JSON-RPC API](https://www.jsonrpc.org/specification) for interacting with it. This API allows you to execute contract calls, retrieve transaction information, and perform various blockchain operations.

## GenLayer Methods

### gen_call

Simulate a contract call. This method supports read operations, write operations, and contract deployments.

**Method:** `gen_call`

**Parameters:**

- `request` (object, required): The contract call request parameters
  - `from` (string, required): The address making the call
  - `to` (string, required): The contract address to call
  - `data` (string, required): The encoded function call data
  - `type` (string, required): The type of call (`"read"`, `"write"`, or `"deploy"`)
  - `transaction_hash_variant` (string, required): `"latest-final"`
  - `gas` (string, optional): Gas limit for the call (hex-encoded)
  - `value` (string, optional): The value to send with the call (hex-encoded)
    **Returns:** Hex-encoded result data

**Example - Read Call:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_call",
  "params": [
    {
      "Type": "read",
      "Data": "0xd8960e066d6574686f646c6765745f686176655f636f696e00",
      "from": "0xf6A60752C24Cd3BFcAf8d387a5EB62d3746F44EE",
      "to": "0xCe5712E63fd5475288aB1B7c0a368B9417357b81",
      "transaction_hash_variant": "latest-final",
      "gas": "0x5208",
      "value": "0x0"
    }
  ],
  "id": 1
}
```

**Example - Write Call:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_call",
  "params": [
    {
      "from": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
      "to": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
      "data": "0xa9059cbb000000000000000000000000742d35cc6634c0532925a3b8d4c9db96c4b4d8b6",
      "type": "write",
      "gas": "0x5208",
      "value": "0x0"
    }
  ],
  "id": 1
}
```

### gen_getContractSchema

Retrieve the schema/interface of a GenLayer contract to understand its available methods and properties.

**Method:** `gen_getContractSchema`

**Parameters:**

- `request` (object, required): The contract schema request
  - `code` (string, required): Base64-encoded contract code

**Returns:** Contract schema object with methods and properties

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_getContractSchema",
  "params": [
    {
      "code": "ZnJvbSBnZW5sYXllciBpbXBvcnQgKg=="
    }
  ],
  "id": 1
}
```

### gen_transactionStatus

Get the current status of a transaction by its hash.

**Method:** `gen_transactionStatus`

**Parameters:**

- `transactionHash` (string, required): The transaction hash

**Returns:** Transaction status object

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_transactionStatus",
  "params": ["0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6"],
  "id": 1
}
```

### gen_getTransactionReceipt

Get the receipt of a completed transaction, containing execution details and results.

**Method:** `gen_getTransactionReceipt`

**Parameters:**

- `transactionHash` (string, required): The transaction hash

**Returns:** Transaction receipt object

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_getTransactionReceipt",
  "params": ["0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6"],
  "id": 1
}
```

### gen_estimateGas

Estimate the amount of gas required for a transaction before executing it.

**Method:** `gen_estimateGas`

**Parameters:**

- `transaction` (object, required): The transaction to estimate gas for

**Returns:** Hex-encoded gas estimate

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_estimateGas",
  "params": [
    {
      "from": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
      "to": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
      "data": "0x70a08231000000000000000000000000742d35cc6634c0532925a3b8d4c9db96c4b4d8b6"
    }
  ],
  "id": 1
}
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "result": "0x5208",
  "id": 1
}
```

### gen_protocolVersion

Get the current protocol version of the GenLayer node.

**Method:** `gen_protocolVersion`

**Parameters:** None

**Returns:** Protocol version string

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_protocolVersion",
  "params": [],
  "id": 1
}
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "result": "1.0.0",
  "id": 1
}
```

## Debug Methods

These methods are available for debugging and testing purposes during development.

### gen_dbg_ping

Simple connectivity test method that returns a "pong" response.

**Method:** `gen_dbg_ping`

**Parameters:** None

**Returns:** "pong" string

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_dbg_ping",
  "params": [],
  "id": 1
}
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "result": "pong",
  "id": 1
}
```

### gen_dbg_load_test

Execute a load test for performance debugging and testing purposes.

**Method:** `gen_dbg_load_test`

**Parameters:** None

**Returns:** Load test result object

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_dbg_load_test",
  "params": [],
  "id": 1
}
```

### gen_dbg_trie

Get trie information for debugging blockchain state and transaction processing.

**Method:** `gen_dbg_trie`

**Parameters:**

- `request` (object, required): The trie debug request
  - `txID` (string, required): Transaction ID (hex-encoded)
  - `round` (integer, required): Round number

**Returns:** Trie debug information string

**Example:**

```json
{
  "jsonrpc": "2.0",
  "method": "gen_dbg_trie",
  "params": [
    {
      "txID": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6742d35Cc6634C0532925a3b8",
      "round": 1
    }
  ],
  "id": 1
}
```

## Ethereum Compatibility

The GenLayer Node also supports Ethereum-compatible methods that are proxied to the underlying infrastructure. These methods follow the standard Ethereum JSON-RPC specification and are prefixed with `eth_`.

**Examples of supported Ethereum methods:**

- `eth_blockNumber`
- `eth_getBalance`
- `eth_sendTransaction`
- `eth_call`
- And other standard Ethereum JSON-RPC methods

## zkSync Compatibility

zkSync-compatible methods are also supported and proxied to the underlying infrastructure. These methods are prefixed with `zksync_`.

## Error Handling

All methods may return standard JSON-RPC errors:

- `-32700`: Parse error
- `-32600`: Invalid Request
- `-32601`: Method not found
- `-32602`: Invalid params
- `-32603`: Internal error
- `-32000` to `-32099`: Server error (implementation-defined)

**Example Error Response:**

```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32602,
    "message": "Invalid params"
  },
  "id": 1
}
```

## Usage Examples

### JavaScript/Node.js

```javascript
const axios = require("axios");

async function callGenLayerNode(method, params = []) {
  const response = await axios.post("http://localhost:9151", {
    jsonrpc: "2.0",
    method: method,
    params: params,
    id: 1,
  });

  return response.data.result;
}

// Example: Get protocol version
const version = await callGenLayerNode("gen_protocolVersion");
console.log("Protocol version:", version);

// Example: Execute a read call
const result = await callGenLayerNode("gen_call", [
  {
    from: "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
    to: "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
    data: "0x70a08231000000000000000000000000742d35cc6634c0532925a3b8d4c9db96c4b4d8b6",
    type: "read",
  },
]);
console.log("Call result:", result);
```

### Python

```python
import requests
import json

def call_genlayer_node(method, params=None):
    if params is None:
        params = []

    payload = {
        "jsonrpc": "2.0",
        "method": method,
        "params": params,
        "id": 1
    }

    response = requests.post('http://localhost:9151', json=payload)
    return response.json()['result']

# Example: Test connectivity
pong = call_genlayer_node('gen_dbg_ping')
print(f'Ping response: {pong}')

# Example: Get transaction status
status = call_genlayer_node('gen_transactionStatus', ['0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6'])
print(f'Transaction status: {status}')
```

### cURL

```bash
# Test connectivity
curl -X POST http://localhost:9151 \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "gen_dbg_ping",
    "params": [],
    "id": 1
  }'

# Execute a contract call
curl -X POST http://localhost:9151 \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "gen_call",
    "params": [{
      "from": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
      "to": "0x742d35Cc6634C0532925a3b8D4C9db96c4b4d8b6",
      "data": "0x70a08231000000000000000000000000742d35cc6634c0532925a3b8d4c9db96c4b4d8b6",
      "type": "read"
    }],
    "id": 1
  }'
```
