# Equivalence Principle 

The Equivalence Principle is a cornerstone in ensuring that Intelligent Contracts function consistently across various validators when handling non-deterministic outputs like responses from Large Language Models (LLMs) or data retrieved through web browsing. It plays a crucial role in how validators assess and agree on the outcomes proposed by the Leader.

Equivalence Principle protects the network from manipulations or errors by ensuring that only suitable, equivalent outcomes influence the blockchain state.

## Types of Equivalence Principles

Validators work to reach a consensus on whether the result set by the Leader is acceptable which might involve direct comparison or qualitative evaluation, depending on the contract’s design. If the validators do not reach a consensus perhaps due to differing data interpretations or an error in data processing, the result might be challenged or an appeal process might be initiated.

### Comparative Equivalence Principle

In the Comparative Equivalence Principle both the Leader and the validators perform identical tasks and then directly compare their respective results with the predefined criteria in the Equivalence Principle to ensure consistency and accuracy. This method uses an acceptable margin of error to handle slight variations in results between validators and is suitable for quantifiable outputs. However, since multiple validators perform the same tasks as the Leader, it increases computational demands and associated costs.

For example, an intelligent contract is tasked with fetching the follower count of a Twitter account and the Equivalence Principle specify that _Follower counts should not differ by more than 5%_. If the Leader retrieves a count of 42 followers, and the validators find a count of 43 followers. The validators will evaluate their result against the Leader's figure based on the criteria set by the Equivalence Principle to decide if the difference falls within the acceptable margin. 

This is set with the `comparative=True` parameter is the Equivalence Principle constructor.


import Image from 'next/image'

<Image src="/comparative-eq.png" alt="Contract state" width={400} height={400} />

### Non-Comparative Equivalence Principle

In contrast, the Non-Comparative Equivalence Principle does not require validators to replicate the Leader's output which makes the validation process faster and less costly. Instead, validators assess the accuracy of the leader’s result against the criteria defined in the Equivalence Principle. This method is particularly useful for qualitative outputs like text summaries.

For example, consider an intelligent contract designed to summarize a news article. The Equivalence Principle specifies that _the summary has to have all the key points of the source article_. The leader executes this task and the validators do not generate their own summaries; instead, they evaluate the leader’s summary against the criteria set by the Equivalence Principle to determine accuracy and completeness.

This is set with the `comparative=False` parameter is the Equivalence Principle constructor.

## Benefits of using the Equivalence Principle

- Allows different LLMs to produce varied outputs while still achieving consensus.
- Enhances security by allowing validators to check each other's work.
- Enables developers to fine-tune how outputs are validated, optimizing for performance or accuracy.

## Key Points for Developers

- **Setting Equivalence Criteria:** Developers must define what 'equivalent' means for each non-deterministic operation in their Intelligent Contract. This guideline helps validators judge if different outcomes are close enough to be treated as the same.

- **Ensuring Contract Reliability:** By clearly defining equivalence, developers help maintain the reliability and predictability of their contracts, even when those contracts interact with the unpredictable web or complex AI models.

